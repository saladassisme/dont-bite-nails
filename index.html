<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>防咬指甲监控器</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
</head>
<body>

    <button id="langSwitch" class="lang-btn">🇺🇸 English</button>

    <h1 data-i18n="title">🚫 不要咬指甲！</h1>
    
    <div class="container">
        
        <!-- 新增：数据统计面板 -->
        <div class="stats-panel">
            <!-- 左边：今日数据 -->
            <div class="stat-box">
                <div class="stat-label" data-i18n="stat_today">今日咬手次数</div>
                <div class="stat-value" id="todayCount">0</div>
            </div>
            <!-- 右边：坚持时间 -->
            <div class="stat-box">
                <div class="stat-label" data-i18n="stat_streak">已坚持 (未咬)</div>
                <div class="stat-value highlight" id="streakTimer">00:00:00</div>
            </div>
        </div>

        <!-- 新增：热力图 (GitHub Style) -->
        <div class="heatmap-container">
            <p class="tip-text" style="margin:0 0 10px 0;" data-i18n="heatmap_title">📅 过去 30 天记录 (颜色越红=咬得越多)</p>
            <div class="heatmap-grid" id="heatmap"></div>
        </div>

        <p id="status" data-i18n="status_wait">⏳ 等待摄像头授权...</p>
        
        <div class="video-wrapper">
            <video id="webcam" autoplay playsinline></video>
            <canvas id="output_canvas"></canvas>
        </div>

        <p class="tip-text" data-i18n="tip">
            💡 提示：点击下方 <b>"开启悬浮小窗"</b> 可隐藏此页面，后台继续监控
        </p>

        <div class="controls">
            <button id="pipButton" class="mdc-button mdc-button--outlined" style="display: none;">
                <span class="mdc-button__label" data-i18n="btn_pip">📺 开启悬浮小窗</span>
            </button>

            <button id="enableWebcamButton" class="mdc-button mdc-button--raised">
                <span class="mdc-button__label" data-i18n="btn_start">开启摄像头监控</span>
            </button>

            <button id="donateButton" class="mdc-button mdc-button--raised coffee-btn">
                <span class="mdc-button__label" data-i18n="btn_donate">🧧 支持作者</span>
            </button>
        </div>
    </div>

    <!-- 弹窗保持不变 -->
    <div id="qrModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h3 data-i18n="modal_title">感谢你的支持！❤️</h3>
            <img src="qr.jpg" alt="收款码" class="qr-img">
            <p data-i18n="modal_desc">微信 / 支付宝 扫一扫</p>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>